test(
    coalesce,
    "select coalesce(NULL, 1)",
    1
)

test(
    coalesce_2,
    "select coalesce(NULL, NULL, 1)",
    1
)

test(
    coalesce_nested,
    "select coalesce(NULL, coalesce(NULL, NULL))",
    Null
)

test(
    coalesce_nested_2_1,
    "select coalesce(NULL, coalesce(NULL, 2))",
    2
)

test(
    coalesce_nested_2_2,
    "select coalesce(NULL, coalesce(1, 2))",
    1
)

test(
    coalesce_nested_2_3,
    "select coalesce(0, coalesce(1, 2))",
    0
)

test(
    coalesce_null,
    "select coalesce(NULL, NULL, NULL)",
    Null
)

test(
    coalesce_first,
    "select coalesce(1, 2, 3)",
    1
)

test(
    coalesce_from_table,
    "select coalesce(NULL, 1) from users limit 1",
    1
)

test(
    coalesce_from_table_column,
    "select coalesce(NULL, age) from users where age = 94 limit 1",
    94
)

test(
    coalesce_from_table_multiple_columns,
    "select coalesce(NULL, age), coalesce(NULL, id) from users where age = 94 limit 1",
    [94, 1]
)