use limbo_ext::{ExtensionApi, ResultCode, VTabCursor, VTabModule, VTabModuleDerive, Value};

#[derive(Debug, VTabModuleDerive)]
pub struct {{struct_prefix}}VTab;

impl VTabModule for {{struct_prefix}}VTab {
    type VCursor = {{struct_prefix}}Cursor;
    const NAME: &'static str = "{{name}}";

    fn connect(api: &ExtensionApi) -> ResultCode {
        // Create table schema
        // TODO: change schema of your vtable
        let sql = "CREATE TABLE {{name}}(
            value INTEGER,
        )";
        api.declare_virtual_table(Self::NAME, sql)
    }

    fn open() -> Self::VCursor {
        {{struct_prefix}}Cursor {}
    }

    fn filter(cursor: &mut Self::VCursor, arg_count: i32, args: &[Value]) -> ResultCode {
        todo!()
    }

    fn column(cursor: &Self::VCursor, idx: u32) -> Value {
        cursor.column(idx)
    }

    fn next(cursor: &mut Self::VCursor) -> ResultCode {
        cursor.next()
    }

    fn eof(cursor: &Self::VCursor) -> bool {
        cursor.eof()
    }
}

/// The cursor for iterating over the generated rows
#[derive(Debug)]
pub struct {{struct_prefix}}Cursor {}

impl {{struct_prefix}}Cursor {}

impl VTabCursor for {{struct_prefix}}Cursor {
    type Error = ResultCode;

    fn next(&mut self) -> ResultCode {
        todo!()
    }

    fn eof(&self) -> bool {
        todo!()
    }

    fn column(&self, idx: u32) -> Value {
        todo!()
    }

    fn rowid(&self) -> i64 {
        todo!()
    }
}

#[cfg(test)]
mod tests {}
